<html>
    <head>
        <title>canvas example animation basics</title>
    </head>
    <body>
<div id="canvas-app" style="width:320px;height:240px;margin-left:auto;margin-right:auto;"></div>
<script>var FF=function(opt){var api={};opt=opt||{};api.ani={ver:opt.ver||'0.0.0'};api.forFrame=opt.forFrame||function(){};var setMainPerAndBias=function(api){api.per=api.frameIndex/api.maxFrame;api.bias=1-Math.abs(0.5-api.per)/0.5;};var forFrame=function(frameIndex,maxFrame){api.frameIndex=frameIndex;api.maxFrame=maxFrame;setMainPerAndBias(api);api.forFrame.call(api,api,frameIndex,maxFrame);return api.ani;};return function(frame,maxFrame){frame=frame===undefined?0:frame;maxFrame=maxFrame===undefined?50:maxFrame;frame=frame>maxFrame?frame%maxFrame:frame;frame=frame<0?maxFrame-Math.abs(frame)%maxFrame:frame;api.ani.frame=frame;api.ani.maxFrame=maxFrame;forFrame(frame,maxFrame);return api;};};var draw={};draw.bx=function(ctx,bx){ctx.fillStyle='red';ctx.strokeStyle='white';ctx.beginPath();ctx.rect(bx.x,bx.y,bx.w,bx.h);ctx.fill();ctx.stroke();};draw.info=function(ctx,ani){ctx.fillStyle='white';ctx.textBaseline='top';ctx.font='10px courier';ctx.fillText(ani.frame+'/'+ani.maxFrame,10,10);ctx.fillText('v'+ani.ver,10,20);};draw.back=function(ctx,canvas){ctx.fillStyle='black';ctx.fillRect(0,0,canvas.width,canvas.height);};var container=document.getElementById('canvas-app'),canvas=document.createElement('canvas'),ctx=canvas.getContext('2d');ctx.translate(0.5,0.5);canvas.width=320;canvas.height=240;container.appendChild(canvas);var opt={ver:'0.0.0',forFrame:function(api,f,mf){var bx=api.ani.bx={w:32,h:32};bx.x=(canvas.width-32)*api.per;bx.y=canvas.height/2-16+canvas.height/4*api.bias;}};var forFrame=FF(opt),api,frame=0,maxFrame=50,FPS=24,lt=new Date();var loop=function(){var now=new Date(),t=now-lt,secs=t/1000,bx;requestAnimationFrame(loop);api=forFrame(Math.floor(frame),maxFrame);draw.back(ctx,canvas);draw.bx(ctx,api.ani.bx);draw.info(ctx,api.ani);frame+=FPS*secs;frame%=maxFrame;lt=now;};loop();</script>
    </body>
</html>