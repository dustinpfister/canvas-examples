/*
   canvas-example-animation-fractal by Dustin Pfister
*/
var FF=function(opt){var api={};opt=opt||{};api.ani={ver:opt.ver||"0.0.a"};api.forFrame=opt.forFrame||function(){};var setMainPerAndBias=function(api){api.per=api.frameIndex/api.maxFrame;api.bias=1-Math.abs(.5-api.per)/.5};var forFrame=function(frameIndex,maxFrame){api.frameIndex=frameIndex;api.maxFrame=maxFrame;setMainPerAndBias(api);api.forFrame.call(api,api,frameIndex,maxFrame);return api.ani};return function(frame,maxFrame){frame=frame===undefined?0:frame;maxFrame=maxFrame===undefined?50:maxFrame;frame=frame>maxFrame?frame%maxFrame:frame;frame=frame<0?maxFrame-Math.abs(frame)%maxFrame:frame;forFrame(frame,maxFrame);return api.ani}};var draw={};draw.bx=function(ctx,bx){ctx.strokeStyle="white";ctx.globalAlpha=.05+bx.per*.95;ctx.lineWidth=6;ctx.beginPath();ctx.rect(bx.x,bx.y,bx.w,bx.h);ctx.stroke()};draw.bxArr=function(ctx,ani){var i=0,len=ani.bxArr.length;ctx.save();while(i<len){draw.bx(ctx,ani.bxArr[i]);i+=1}ctx.restore()};draw.back=function(ctx,canvas){ctx.fillStyle="black";ctx.fillRect(0,0,canvas.width,canvas.height)};draw.ver=function(ctx,canvas,ani){ctx.fillStyle="white";ctx.textBaseline="top";ctx.font="10px courier";ctx.fillText("v"+ani.ver,10,canvas.height-15)};var container=document.getElementById("canvas-app"),canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");canvas.width=320;canvas.height=240;ctx.translate(.5,.5);container.appendChild(canvas);var opt={ver:"0.0.0",forFrame:function(api,f,mf){var bxArr=api.ani.bxArr=[];var i=0,per,bxCount=10,maxSize=canvas.width;while(i<bxCount){per=api.per+1/bxCount*i;per%=1;bx={};bx.w=maxSize*per;bx.h=maxSize*per;bx.x=canvas.width/2-bx.w/2;bx.y=canvas.height/2-bx.h/2;bx.per=bx.w/maxSize;bxArr.push(bx);i+=1}bxArr.sort(function(a,b){if(a.per>b.per){return 1}return-1})}};var ani=FF(opt);var frame=0;var loop=function(){requestAnimationFrame(loop);var state=ani(frame,200);draw.back(ctx,canvas);draw.bxArr(ctx,state);draw.ver(ctx,canvas,state);frame+=1;frame%=200};loop();
